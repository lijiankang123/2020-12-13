define("mui/view-port-listen/index",function(e,t,o){var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,o,n){if(o)e(t.prototype,o);if(n)e(t,n);return t}}();function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var l=e("mui/zepto/touch"),s=window;var r=function a(e,t,o){var n=undefined,i=undefined;return function(){if(n&&Date.now()-n<t){if(i){clearTimeout(i)}i=setTimeout(function(){e.call(o);n=Date.now()},t);return}e.call(o);n=Date.now()}};var f=function(){function e(t){i(this,e);var o=this;o.options=Object.assign({},{listenItems:[],listenCallback:function n(){},diff:0,bufferTime:200},t);o.scrollEvent=false;o.destroyed=false;o.scrollBuffer=r(o.__listenScroll,o.options.bufferTime,o);if(o.options.listenItems){if(!o.options.listenItems.length){o.options.listenItems=[].concat(o.options.listenItems)}else if(!o.options.listenItems.slice){o.options.listenItems=[].slice.call(o.options.listenItems)}o.__listenScroll()}else{o.options.listenItems=[]}}n(e,[{key:"__listenScroll",value:function t(){var e=this,t=e.options.listenItems,o=e.options.listenCallback,n=e._getViewPortHeight(),i=t.length,r=undefined;if(t.getDOMNodes){t=t.getDOMNodes()}e.destroyed=true;while(i--){r=l(t[i]);var f=e._getElementViewTop(r);if(f){e.destroyed=false;if(e.isInViewPortHeight(f,n)){delete t[i];o&&o.call(r)}}}if(e.scrollEvent&&e.destroyed){l(s).off("scroll",e.scrollBuffer);e.scrollEvent=false}else if(!e.scrollEvent&&!e.destroyed){l(s).on("scroll",e.scrollBuffer);e.scrollEvent=true}}},{key:"addItems",value:function o(e){var t=this;t.options.listenItems=t.options.listenItems.concat(e);t.__listenScroll()}},{key:"isInViewPortHeight",value:function f(e,t){var o=this,n=o.options.diff,i={top:0,bottom:0};if(typeof n==="number"){i.bottom=n}else{i.top=n.top&&typeof n.top==="number"?n.top:0;i.bottom=n.bottom&&typeof n.bottom==="number"?n.bottom:0}return e.min>=-i.top&&e.min<=t+i.bottom||e.max>=-i.top&&e.max<=t+i.bottom||e.min>=-i.top&&e.max<=t+i.bottom||e.min<=-i.top&&e.max>=t+i.bottom}},{key:"_getElementViewTop",value:function a(e){if(e&&e.length){var t=l(e).get(0).getBoundingClientRect().top,o=e.height();return{min:t,max:t+o}}else{return false}}},{key:"_getViewPortHeight",value:function u(){return l(s).height()}}]);return e}();o.exports=f});